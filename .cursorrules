# Cursor Rules pour Kiko

## Audio System - CRITIQUE ⚠️

AVANT de modifier `/hooks/useAudio.ts` ou `/hooks/game/usePrecisionAudio.ts`:
1. LIRE `/docs/AUDIO_MIGRATION_GUIDE.md`
2. Utiliser UNIQUEMENT `expo-av` (pas expo-audio)
3. expo-audio 0.3.5 est ENTIÈREMENT BUGGÉ dans SDK 52

Bug connu: TOUT expo-audio 0.3.5 provoque "Error: Value is undefined, expected an Object"

## Pattern Audio Correct

```typescript
// ✅ CORRECT - expo-av
import { Audio } from 'expo-av';
const { sound } = await Audio.Sound.createAsync(require('./sound.wav'));
await sound.playAsync();

// ❌ INTERDIT - expo-audio (buggé)
import { createAudioPlayer, useAudioPlayer } from 'expo-audio';
const player = createAudioPlayer(...); // CRASH
const player = useAudioPlayer(...); // CRASH AUSSI
```

IMPORTANT: expo-av est un module natif. Après modification audio:
- Rebuilder: `npx expo prebuild --clean && cd android && ./gradlew assembleDebug`

## Règles générales

1. Projet utilise Expo SDK 52, pas SDK 53
2. expo-audio version 0.3.5 (ne pas upgrader vers 1.0.14+)
3. TypeScript strict sur les nouveaux fichiers
4. Tous les sons dans `/assets/sounds/`
5. Documentation dans `/docs/`

## Voir aussi

- `/docs/README.md` - Index documentation
- `/docs/AUDIO_MIGRATION_GUIDE.md` - Migration expo-audio
- `/.ai-context.md` - Context général pour IA
